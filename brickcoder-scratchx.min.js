(function(s){function o(d){if(a[d])return a[d].exports;var p=a[d]={exports:{},id:d,loaded:!1};return s[d].call(p.exports,p,p.exports,o),p.loaded=!0,p.exports}var a={};return o.m=s,o.c=a,o.p='',o(0)})([function(s,o,a){(function(d){'use strict';const p=a(1),u=a(2),_=new u.Client('https://faye.brickcoder.com/bayeux'),h=a(40);let m=!1,f=new h('',_);_.on('transport:up',()=>{console.log('transport:up'),m=!0}),_.on('transport:down',()=>{console.log('transport:down'),m=!1}),_.connect(),d._shutdown=()=>{f.disconnect(),_.disconnect()},d._getStatus=()=>{return''===f.id?{status:1,msg:p.getStatus().deviceSerialNumberIsNotSet}:m?!0===f.isConnected?{status:2,msg:p.getStatus().connectedToDevice+f.id}:{status:1,msg:p.getStatus().deviceNotFound}:{status:3,msg:p.getStatus().noConnectionToServer}},d.isDeviceReady=()=>{return 2===d._getStatus().status},d.connectToDevice=y=>{y!==f.id&&(f.disconnect(),f=new h(y,_)),f.connect()},d.sendSingleOutputPwm=(y,E,C)=>{console.log('speed='+y+' direction='+E+' channel_output='+C),f.send({type:'LPF_CMD',mode:'single',channel:'1',output:'A',step:'3',direction:'fw',repeat:'false'})};const b={blocks:p.getBlocks(),menus:p.getMenus(),url:'http://brickcoder.github.io/scratchx-extension'};ScratchExtensions.register('Brickcoder',b,d)})({})},function(s){const o=['en','de'],a={en:[[' ','connect to Brickcoder device with serial number %s','connectToDevice',''],['b','device ready','isDeviceReady'],[' ','send %m.step %m.direction to %m.device','sendSingleOutputPwm','3','forward','1 RED']],de:[[' ','Verbinde zu Brickcoder Ger\xE4t mit Seriennummer %s','connectToDevice',''],['b','Ger\xE4t bereit','isDeviceReady'],[' ','Sende %m.step %m.direction an %m.device','sendSingleOutputPwm','3','vorw\xE4rts','1 ROT']]},d={en:{device:['1 RED','1 BLUE','2 RED','2 BLUE','3 RED','3 BLUE','4 RED','4 BLUE'],step:['0','1','2','3','4','5','6','7'],direction:['forward','backward']},de:{device:['1 ROT','1 BLAU','2 ROT','2 BLAU','3 ROT','3 BLAU','4 ROT','4 BLAU'],step:['0','1','2','3','4','5','6','7'],direction:['vorw\xE4rts','r\xFCckw\xE4rts']}},p={en:{deviceSerialNumberIsNotSet:'Device serial number is not set',noConnectionToServer:'No connection to server',connectedToDevice:'Connected to device ',deviceNotFound:'Device not found. Please check serial number.'},de:{deviceSerialNumberIsNotSet:'Seriennummer des Ger\xE4ts ist nicht gesetzt',noConnectionToServer:'Keine Verbindung zum Server',connectedToDevice:'Verbunden mit Ger\xE4t ',deviceNotFound:'Ger\xE4t nicht gefunden. Bitte Seriennummer pr\xFCfen.'}},u=()=>{const h=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage;return h.substr(0,2)},_=()=>{const h=u();return console.log('browserLanguage='+h),-1<o.indexOf(h)?(console.log('getLanguage='+h),h):(console.log('getLanguage='+o[0]),o[0])};s.exports={getBlocks:()=>a[_()],getMenus:()=>d[_()],getStatus:()=>p[_()]}},function(s,o,a){'use strict';var d=a(3),p=a(4),u={VERSION:d.VERSION,Client:a(6),Scheduler:a(35)};p.wrapper=u,s.exports=u},function(s){s.exports={VERSION:'1.2.3',BAYEUX_VERSION:'1.0',ID_LENGTH:160,JSONP_CALLBACK:'jsonpcallback',CONNECTION_TYPES:['long-polling','cross-origin-long-polling','callback-polling','websocket','eventsource','in-process'],MANDATORY_CONNECTION_TYPES:['long-polling','callback-polling','in-process']}},function(s,o,a){'use strict';var d=a(5),p={LOG_LEVELS:{fatal:4,error:3,warn:2,info:1,debug:0},writeLog:function(_,h){var m=p.logger||(p.wrapper||p).logger;if(m){var f=Array.prototype.slice.apply(_),b='[Faye',y=this.className,E=f.shift().replace(/\?/g,function(){try{return d(f.shift())}catch(N){return'[Object]'}});y&&(b+='.'+y),b+='] ','function'==typeof m[h]?m[h](b+E):'function'==typeof m&&m(b+E)}}};for(var u in p.LOG_LEVELS)(function(_){p[_]=function(){this.writeLog(arguments,_)}})(u);s.exports=p},function(s){'use strict';s.exports=function(o){return JSON.stringify(o,function(a,d){return this[a]instanceof Array?this[a]:d})}},function(s,o,a){(function(d){'use strict';var p=a(7),u=a(9),_=a(11),h=a(12),m=a(13),f=a(14),b=a(3),y=a(10),E=a(15),C=a(16),N=a(4),T=a(17),S=a(19),O=a(21),I=a(36),D=a(37),R=a(38),w=a(39),U=u({className:'Client',UNCONNECTED:1,CONNECTING:2,CONNECTED:3,DISCONNECTED:4,HANDSHAKE:'handshake',RETRY:'retry',NONE:'none',CONNECTION_TIMEOUT:60,DEFAULT_ENDPOINT:'/bayeux',INTERVAL:0,initialize:function(L,A){this.info('New client created for ?',L),A=A||{},E(A,['interval','timeout','endpoints','proxy','retry','scheduler','websocketExtensions','tls','ca']),this._channels=new S.Set,this._dispatcher=O.create(this,L||this.DEFAULT_ENDPOINT,A),this._messageId=0,this._state=this.UNCONNECTED,this._responseCallbacks={},this._advice={reconnect:this.RETRY,interval:1e3*(A.interval||this.INTERVAL),timeout:1e3*(A.timeout||this.CONNECTION_TIMEOUT)},this._dispatcher.timeout=this._advice.timeout/1e3,this._dispatcher.bind('message',this._receiveMessage,this),f.Event&&d.onbeforeunload!==void 0&&f.Event.on(d,'beforeunload',function(){0>m.indexOf(this._dispatcher._disabled,'autodisconnect')&&this.disconnect()},this)},addWebsocketExtension:function(L){return this._dispatcher.addWebsocketExtension(L)},disable:function(L){return this._dispatcher.disable(L)},setHeader:function(L,A){return this._dispatcher.setHeader(L,A)},handshake:function(L,A){if(this._advice.reconnect!==this.NONE&&this._state===this.UNCONNECTED){this._state=this.CONNECTING;var M=this;this.info('Initiating handshake with ?',h.stringify(this._dispatcher.endpoint)),this._dispatcher.selectTransport(b.MANDATORY_CONNECTION_TYPES),this._sendMessage({channel:S.HANDSHAKE,version:b.BAYEUX_VERSION,supportedConnectionTypes:this._dispatcher.getConnectionTypes()},{},function(P){P.successful?(this._state=this.CONNECTED,this._dispatcher.clientId=P.clientId,this._dispatcher.selectTransport(P.supportedConnectionTypes),this.info('Handshake successful: ?',this._dispatcher.clientId),this.subscribe(this._channels.getKeys(),!0),L&&p(function(){L.call(A)})):(this.info('Handshake unsuccessful'),d.setTimeout(function(){M.handshake(L,A)},1e3*this._dispatcher.retry),this._state=this.UNCONNECTED)},this)}},connect:function(L,A){if(this._advice.reconnect!==this.NONE&&this._state!==this.DISCONNECTED){if(this._state===this.UNCONNECTED)return this.handshake(function(){this.connect(L,A)},this);this.callback(L,A),this._state===this.CONNECTED&&(this.info('Calling deferred actions for ?',this._dispatcher.clientId),this.setDeferredStatus('succeeded'),this.setDeferredStatus('unknown'),!this._connectRequest&&(this._connectRequest=!0,this.info('Initiating connection for ?',this._dispatcher.clientId),this._sendMessage({channel:S.CONNECT,clientId:this._dispatcher.clientId,connectionType:this._dispatcher.connectionType},{},this._cycleConnection,this)))}},disconnect:function(){if(this._state===this.CONNECTED){this._state=this.DISCONNECTED,this.info('Disconnecting ?',this._dispatcher.clientId);var L=new R;return this._sendMessage({channel:S.DISCONNECT,clientId:this._dispatcher.clientId},{},function(M){M.successful?(this._dispatcher.close(),L.setDeferredStatus('succeeded')):L.setDeferredStatus('failed',I.parse(M.error))},this),this.info('Clearing channel listeners for ?',this._dispatcher.clientId),this._channels=new S.Set,L}},subscribe:function(L,A,M){if(L instanceof Array)return m.map(L,function(B){return this.subscribe(B,A,M)},this);var q=new w(this,L,A,M),P=!0===A,H=this._channels.hasSubscription(L);return H&&!P?(this._channels.subscribe([L],q),q.setDeferredStatus('succeeded'),q):(this.connect(function(){this.info('Client ? attempting to subscribe to ?',this._dispatcher.clientId,L),P||this._channels.subscribe([L],q),this._sendMessage({channel:S.SUBSCRIBE,clientId:this._dispatcher.clientId,subscription:L},{},function(B){if(!B.successful)return q.setDeferredStatus('failed',I.parse(B.error)),this._channels.unsubscribe(L,q);var F=[].concat(B.subscription);this.info('Subscription acknowledged for ? to ?',this._dispatcher.clientId,F),q.setDeferredStatus('succeeded')},this)},this),q)},unsubscribe:function(L,A){if(L instanceof Array)return m.map(L,function(q){return this.unsubscribe(q,A)},this);var M=this._channels.unsubscribe(L,A);M&&this.connect(function(){this.info('Client ? attempting to unsubscribe from ?',this._dispatcher.clientId,L),this._sendMessage({channel:S.UNSUBSCRIBE,clientId:this._dispatcher.clientId,subscription:L},{},function(q){if(q.successful){var P=[].concat(q.subscription);this.info('Unsubscription acknowledged for ? from ?',this._dispatcher.clientId,P)}},this)},this)},publish:function(L,A,M){E(M||{},['attempts','deadline']);var q=new R;return this.connect(function(){this.info('Client ? queueing published message to ?: ?',this._dispatcher.clientId,L,A),this._sendMessage({channel:L,data:A,clientId:this._dispatcher.clientId},M,function(P){P.successful?q.setDeferredStatus('succeeded'):q.setDeferredStatus('failed',I.parse(P.error))},this)},this),q},_sendMessage:function(L,A,M,q){L.id=this._generateMessageId();var P=this._advice.timeout?1.2*this._advice.timeout/1e3:1.2*this._dispatcher.retry;this.pipeThroughExtensions('outgoing',L,null,function(H){H&&(M&&(this._responseCallbacks[H.id]=[M,q]),this._dispatcher.sendMessage(H,P,A||{}))},this)},_generateMessageId:function(){return this._messageId+=1,this._messageId>=Math.pow(2,32)&&(this._messageId=0),this._messageId.toString(36)},_receiveMessage:function(L){var M,A=L.id;L.successful!==void 0&&(M=this._responseCallbacks[A],delete this._responseCallbacks[A]),this.pipeThroughExtensions('incoming',L,null,function(q){q&&(q.advice&&this._handleAdvice(q.advice),this._deliverMessage(q),M&&M[0].call(M[1],q))},this)},_handleAdvice:function(L){y(this._advice,L),this._dispatcher.timeout=this._advice.timeout/1e3,this._advice.reconnect===this.HANDSHAKE&&this._state!==this.DISCONNECTED&&(this._state=this.UNCONNECTED,this._dispatcher.clientId=null,this._cycleConnection())},_deliverMessage:function(L){!L.channel||L.data===void 0||(this.info('Client ? calling listeners for ? with ?',this._dispatcher.clientId,L.channel,L.data),this._channels.distributeMessage(L))},_cycleConnection:function(){this._connectRequest&&(this._connectRequest=null,this.info('Closed connection for ?',this._dispatcher.clientId));var L=this;d.setTimeout(function(){L.connect()},this._advice.interval)}});y(U.prototype,C),y(U.prototype,T),y(U.prototype,N),y(U.prototype,D),s.exports=U}).call(o,function(){return this}())},function(s,o,a){'use strict';function d(f){var b;b=_.length?_.pop():new p,b.task=f,u(b)}function p(){this.task=null}var u=a(8),_=[],h=[],m=u.makeRequestCallFromTimer(function(){if(h.length)throw h.shift()});s.exports=d,p.prototype.call=function(){try{this.task.call()}catch(f){d.onerror?d.onerror(f):(h.push(f),m())}finally{this.task=null,_[_.length]=this}}},function(s,o){(function(a){'use strict';function d(E){h.length||m(),h[h.length]=E}function p(){for(;f<h.length;){var E=f;if(f=f+1,h[E].call(),1024<f){for(var C=0,N=h.length-f;C<N;C++)h[C]=h[C+f];h.length-=f,f=0}}h.length=0,f=0}function u(E){var C=1,N=new y(E),T=document.createTextNode('');return N.observe(T,{characterData:!0}),function(){C=-C,T.data=C}}function _(E){return function(){function N(){clearTimeout(T),clearInterval(S),E()}var T=setTimeout(N,0),S=setInterval(N,50)}}s.exports=d;var h=[],m,f=0,b='undefined'==typeof a?self:a,y=b.MutationObserver||b.WebKitMutationObserver;m='function'==typeof y?u(p):_(p),d.requestFlush=m,d.makeRequestCallFromTimer=_}).call(o,function(){return this}())},function(s,o,a){'use strict';var d=a(10);s.exports=function(p,u){'function'!=typeof p&&(u=p,p=Object);var _=function(){return this.initialize?this.initialize.apply(this,arguments)||this:this},h=function(){};return h.prototype=p.prototype,_.prototype=new h,d(_.prototype,u),_}},function(s){'use strict';s.exports=function(o,a,d){if(!a)return o;for(var p in a)a.hasOwnProperty(p)&&(o.hasOwnProperty(p)&&!1===d||o[p]!==a[p]&&(o[p]=a[p]));return o}},function(s,o,a){'use strict';var d=a(7),p=0,u=1,_=2,h=function(O){return O},m=function(O){throw O},f=function(O){if(this._state=p,this._onFulfilled=[],this._onRejected=[],'function'==typeof O){var I=this;O(function(R){N(I,R)},function(R){S(I,R)})}};f.prototype.then=function(O,I){var D=new f;return b(this,O,D),y(this,I,D),D},f.prototype.catch=function(O){return this.then(null,O)};var b=function(O,I,D){'function'!=typeof I&&(I=h);var R=function(w){E(I,w,D)};O._state===p?O._onFulfilled.push(R):O._state===u&&R(O._value)},y=function(O,I,D){'function'!=typeof I&&(I=m);var R=function(w){E(I,w,D)};O._state===p?O._onRejected.push(R):O._state===_&&R(O._reason)},E=function(O,I,D){d(function(){C(O,I,D)})},C=function(O,I,D){var R;try{R=O(I)}catch(w){return S(D,w)}R===D?S(D,new TypeError('Recursive promise chain detected')):N(D,R)},N=function(O,I){var R,w,D=!1;try{if(R=typeof I,w=null!==I&&('function'===R||'object'===R)&&I.then,'function'!=typeof w)return T(O,I);w.call(I,function(U){D^(D=!0)&&N(O,U)},function(U){D^(D=!0)&&S(O,U)})}catch(U){if(!(D^(D=!0)))return;S(O,U)}},T=function(O,I){if(O._state===p){O._state=u,O._value=I,O._onRejected=[];for(var R,D=O._onFulfilled;R=D.shift();)R(I)}},S=function(O,I){if(O._state===p){O._state=_,O._reason=I,O._onFulfilled=[];for(var R,D=O._onRejected;R=D.shift();)R(I)}};f.resolve=function(O){return new f(function(I){I(O)})},f.reject=function(O){return new f(function(I,D){D(O)})},f.all=function(O){return new f(function(I,D){var U,R=[],w=O.length;if(0===w)return I(R);for(U=0;U<w;U++)(function(L,A){f.resolve(L).then(function(M){R[A]=M,0==--w&&I(R)},D)})(O[U],U)})},f.race=function(O){return new f(function(I,D){for(var R=0,w=O.length;R<w;R++)f.resolve(O[R]).then(I,D)})},f.deferred=f.pending=function(){var O={};return O.promise=new f(function(I,D){O.resolve=I,O.reject=D}),O},s.exports=f},function(s){'use strict';s.exports={isURI:function(o){return o&&o.protocol&&o.host&&o.path},isSameOrigin:function(o){return o.protocol===location.protocol&&o.hostname===location.hostname&&o.port===location.port},parse:function(o){if('string'!=typeof o)return o;var d,p,u,_,h,m,a={},f=function(b,y){o=o.replace(y,function(E){return a[b]=E,''}),a[b]=a[b]||''};for(f('protocol',/^[a-z]+\:/i),f('host',/^\/\/[^\/\?#]+/),/^\//.test(o)||a.host||(o=location.pathname.replace(/[^\/]*$/,'')+o),f('pathname',/^[^\?#]*/),f('search',/^\?[^#]*/),f('hash',/^#.*/),a.protocol=a.protocol||location.protocol,a.host?(a.host=a.host.substr(2),d=a.host.split(':'),a.hostname=d[0],a.port=d[1]||''):(a.host=location.host,a.hostname=location.hostname,a.port=location.port),a.pathname=a.pathname||'/',a.path=a.pathname+a.search,p=a.search.replace(/^\?/,''),u=p?p.split('&'):[],m={},(_=0,h=u.length);_<h;_++)d=u[_].split('='),m[decodeURIComponent(d[0]||'')]=decodeURIComponent(d[1]||'');return a.query=m,a.href=this.stringify(a),a},stringify:function(o){var a=o.protocol+'//'+o.hostname;return o.port&&(a+=':'+o.port),a+=o.pathname+this.queryString(o.query)+(o.hash||''),a},queryString:function(o){var a=[];for(var d in o)o.hasOwnProperty(d)&&a.push(encodeURIComponent(d)+'='+encodeURIComponent(o[d]));return 0===a.length?'':'?'+a.join('&')}}},function(s){'use strict';s.exports={commonElement:function(o,a){for(var d=0,p=o.length;d<p;d++)if(-1!==this.indexOf(a,o[d]))return o[d];return null},indexOf:function(o,a){if(o.indexOf)return o.indexOf(a);for(var d=0,p=o.length;d<p;d++)if(o[d]===a)return d;return-1},map:function(o,a,d){if(o.map)return o.map(a,d);var p=[];if(o instanceof Array)for(var u=0,_=o.length;u<_;u++)p.push(a.call(d||null,o[u],u));else for(var h in o)o.hasOwnProperty(h)&&p.push(a.call(d||null,h,o[h]));return p},filter:function(o,a,d){if(o.filter)return o.filter(a,d);var p=[];for(var u=0,_=o.length;u<_;u++)a.call(d||null,o[u],u)&&p.push(o[u]);return p},asyncEach:function(o,a,d,p){var u=o.length,_=-1,h=0,m=!1,f=function(){return h-=1,_+=1,_===u?d&&d.call(p):void a(o[_],y)},b=function(){if(!m){for(m=!0;0<h;)f();m=!1}},y=function(){h+=1,b()};y()}}},function(s,o){(function(a){'use strict';var d={_registry:[],on:function(p,u,_,h){var m=function(){_.call(h)};p.addEventListener?p.addEventListener(u,m,!1):p.attachEvent('on'+u,m),this._registry.push({_element:p,_type:u,_callback:_,_context:h,_handler:m})},detach:function(p,u,_,h){for(var f,m=this._registry.length;m--;)f=this._registry[m],p&&p!==f._element||u&&u!==f._type||_&&_!==f._callback||h&&h!==f._context||(f._element.removeEventListener?f._element.removeEventListener(f._type,f._handler,!1):f._element.detachEvent('on'+f._type,f._handler),this._registry.splice(m,1),f=null)}};a.onunload!==void 0&&d.on(a,'unload',d.detach,d),s.exports={Event:d}}).call(o,function(){return this}())},function(s,o,a){'use strict';var d=a(13);s.exports=function(p,u){for(var _ in p)if(0>d.indexOf(u,_))throw new Error('Unrecognized option: '+_)}},function(s,o,a){(function(d){'use strict';var p=a(11);s.exports={then:function(u,_){var h=this;return this._promise||(this._promise=new p(function(m,f){h._resolve=m,h._reject=f})),0===arguments.length?this._promise:this._promise.then(u,_)},callback:function(u,_){return this.then(function(h){u.call(_,h)})},errback:function(u,_){return this.then(null,function(h){u.call(_,h)})},timeout:function(u,_){this.then();var h=this;this._timer=d.setTimeout(function(){h._reject(_)},1e3*u)},setDeferredStatus:function(u,_){this._timer&&d.clearTimeout(this._timer),this.then(),'succeeded'===u?this._resolve(_):'failed'===u?this._reject(_):delete this._promise}}}).call(o,function(){return this}())},function(s,o,a){'use strict';var d=a(10),p=a(18),u={countListeners:function(_){return this.listeners(_).length},bind:function(_,h,m){var f=Array.prototype.slice,b=function(){h.apply(m,f.call(arguments))};return this._listeners=this._listeners||[],this._listeners.push([_,h,m,b]),this.on(_,b)},unbind:function(_,h,m){this._listeners=this._listeners||[];for(var b,f=this._listeners.length;f--;)b=this._listeners[f],b[0]!==_||h&&(b[1]!==h||b[2]!==m)||(this._listeners.splice(f,1),this.removeListener(_,b[3]))}};d(u,p.prototype),u.trigger=u.emit,s.exports=u},function(s){function o(p,u){if(p.indexOf)return p.indexOf(u);for(var _=0;_<p.length;_++)if(u===p[_])return _;return-1}function a(){}var d='function'==typeof Array.isArray?Array.isArray:function(p){return'[object Array]'===Object.prototype.toString.call(p)};s.exports=a,a.prototype.emit=function(p){if('error'===p&&(!this._events||!this._events.error||d(this._events.error)&&!this._events.error.length)){if(arguments[1]instanceof Error)throw arguments[1];else throw new Error('Uncaught, unspecified \'error\' event.');return!1}if(!this._events)return!1;var u=this._events[p];if(!u)return!1;if('function'==typeof u){switch(arguments.length){case 1:u.call(this);break;case 2:u.call(this,arguments[1]);break;case 3:u.call(this,arguments[1],arguments[2]);break;default:var _=Array.prototype.slice.call(arguments,1);u.apply(this,_);}return!0}if(d(u)){var _=Array.prototype.slice.call(arguments,1),h=u.slice();for(var m=0,f=h.length;m<f;m++)h[m].apply(this,_);return!0}return!1},a.prototype.addListener=function(p,u){if('function'!=typeof u)throw new Error('addListener only takes instances of Function');return this._events||(this._events={}),this.emit('newListener',p,u),this._events[p]?d(this._events[p])?this._events[p].push(u):this._events[p]=[this._events[p],u]:this._events[p]=u,this},a.prototype.on=a.prototype.addListener,a.prototype.once=function(p,u){var _=this;return _.on(p,function h(){_.removeListener(p,h),u.apply(this,arguments)}),this},a.prototype.removeListener=function(p,u){if('function'!=typeof u)throw new Error('removeListener only takes instances of Function');if(!this._events||!this._events[p])return this;var _=this._events[p];if(d(_)){var h=o(_,u);if(0>h)return this;_.splice(h,1),0==_.length&&delete this._events[p]}else this._events[p]===u&&delete this._events[p];return this},a.prototype.removeAllListeners=function(p){return 0===arguments.length?(this._events={},this):(p&&this._events&&this._events[p]&&(this._events[p]=null),this)},a.prototype.listeners=function(p){return this._events||(this._events={}),this._events[p]||(this._events[p]=[]),d(this._events[p])||(this._events[p]=[this._events[p]]),this._events[p]}},function(s,o,a){'use strict';var d=a(9),p=a(10),u=a(17),_=a(20),h=d({initialize:function(m){this.id=this.name=m},push:function(m){this.trigger('message',m)},isUnused:function(){return 0===this.countListeners('message')}});p(h.prototype,u),p(h,{HANDSHAKE:'/meta/handshake',CONNECT:'/meta/connect',SUBSCRIBE:'/meta/subscribe',UNSUBSCRIBE:'/meta/unsubscribe',DISCONNECT:'/meta/disconnect',META:'meta',SERVICE:'service',expand:function(m){var f=this.parse(m),b=['/**',m],y=f.slice();y[y.length-1]='*',b.push(this.unparse(y));for(var E=1,C=f.length;E<C;E++)y=f.slice(0,E),y.push('**'),b.push(this.unparse(y));return b},isValid:function(m){return _.CHANNEL_NAME.test(m)||_.CHANNEL_PATTERN.test(m)},parse:function(m){return this.isValid(m)?m.split('/').slice(1):null},unparse:function(m){return'/'+m.join('/')},isMeta:function(m){var f=this.parse(m);return f?f[0]===this.META:null},isService:function(m){var f=this.parse(m);return f?f[0]===this.SERVICE:null},isSubscribable:function(m){return this.isValid(m)?!this.isMeta(m)&&!this.isService(m):null},Set:d({initialize:function(){this._channels={}},getKeys:function(){var m=[];for(var f in this._channels)m.push(f);return m},remove:function(m){delete this._channels[m]},hasSubscription:function(m){return this._channels.hasOwnProperty(m)},subscribe:function(m,f){var b;for(var y=0,E=m.length;y<E;y++){b=m[y];var C=this._channels[b]=this._channels[b]||new h(b);C.bind('message',f)}},unsubscribe:function(m,f){var b=this._channels[m];return!!b&&(b.unbind('message',f),!!b.isUnused()&&(this.remove(m),!0))},distributeMessage:function(m){var f=h.expand(m.channel);for(var b=0,y=f.length;b<y;b++){var E=this._channels[f[b]];E&&E.trigger('message',m)}}})}),s.exports=h},function(s){'use strict';s.exports={CHANNEL_NAME:/^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,CHANNEL_PATTERN:/^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/,ERROR:/^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/,VERSION:/^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/}},function(s,o,a){(function(d){'use strict';var p=a(9),u=a(12),_=a(22),h=a(10),m=a(4),f=a(17),b=a(23),y=a(35),E=p({className:'Dispatcher',MAX_REQUEST_SIZE:2048,DEFAULT_RETRY:5,UP:1,DOWN:2,initialize:function(C,N,T){this._client=C,this.endpoint=u.parse(N),this._alternates=T.endpoints||{},this.cookies=_.CookieJar&&new _.CookieJar,this._disabled=[],this._envelopes={},this.headers={},this.retry=T.retry||this.DEFAULT_RETRY,this._scheduler=T.scheduler||y,this._state=0,this.transports={},this.wsExtensions=[],this.proxy=T.proxy||{},'string'==typeof this._proxy&&(this._proxy={origin:this._proxy});var S=T.websocketExtensions;if(S){S=[].concat(S);for(var O=0,I=S.length;O<I;O++)this.addWebsocketExtension(S[O])}for(var D in this.tls=T.tls||{},this.tls.ca=this.tls.ca||T.ca,this._alternates)this._alternates[D]=u.parse(this._alternates[D]);this.maxRequestSize=this.MAX_REQUEST_SIZE},endpointFor:function(C){return this._alternates[C]||this.endpoint},addWebsocketExtension:function(C){this.wsExtensions.push(C)},disable:function(C){this._disabled.push(C)},setHeader:function(C,N){this.headers[C]=N},close:function(){var C=this._transport;delete this._transport,C&&C.close()},getConnectionTypes:function(){return b.getConnectionTypes()},selectTransport:function(C){b.get(this,C,this._disabled,function(N){this.debug('Selected ? transport for ?',N.connectionType,u.stringify(N.endpoint)),N===this._transport||(this._transport&&this._transport.close(),this._transport=N,this.connectionType=N.connectionType)},this)},sendMessage:function(C,N,T){T=T||{};var R,S=C.id,O=T.attempts,I=T.deadline&&new Date().getTime()+1e3*T.deadline,D=this._envelopes[S];D||(R=new this._scheduler(C,{timeout:N,interval:this.retry,attempts:O,deadline:I}),D=this._envelopes[S]={message:C,scheduler:R}),this._sendEnvelope(D)},_sendEnvelope:function(C){if(this._transport&&!(C.request||C.timer)){var N=C.message,T=C.scheduler,S=this;if(!T.isDeliverable())return T.abort(),void delete this._envelopes[N.id];C.timer=d.setTimeout(function(){S.handleError(N)},1e3*T.getTimeout()),T.send(),C.request=this._transport.sendMessage(N)}},handleResponse:function(C){var N=this._envelopes[C.id];C.successful!==void 0&&N&&(N.scheduler.succeed(),delete this._envelopes[C.id],d.clearTimeout(N.timer)),this.trigger('message',C),this._state===this.UP||(this._state=this.UP,this._client.trigger('transport:up'))},handleError:function(C,N){var T=this._envelopes[C.id],S=T&&T.request,O=this;if(S){S.then(function(R){R&&R.abort&&R.abort()});var I=T.scheduler;I.fail(),d.clearTimeout(T.timer),T.request=T.timer=null,N?this._sendEnvelope(T):T.timer=d.setTimeout(function(){T.timer=null,O._sendEnvelope(T)},1e3*I.getInterval()),this._state===this.DOWN||(this._state=this.DOWN,this._client.trigger('transport:down'))}}});E.create=function(C,N,T){return new E(C,N,T)},h(E.prototype,f),h(E.prototype,m),s.exports=E}).call(o,function(){return this}())},function(s){'use strict';s.exports={}},function(s,o,a){'use strict';var d=a(24);d.register('websocket',a(27)),d.register('eventsource',a(31)),d.register('long-polling',a(32)),d.register('cross-origin-long-polling',a(33)),d.register('callback-polling',a(34)),s.exports=d},function(s,o,a){(function(d){'use strict';var p=a(9),u=a(22).Cookie,_=a(11),h=a(12),m=a(13),f=a(10),b=a(4),y=a(26),E=a(19),C=f(p({className:'Transport',DEFAULT_PORTS:{'http:':80,'https:':443,'ws:':80,'wss:':443},MAX_DELAY:0,batching:!0,initialize:function(N,T){this._dispatcher=N,this.endpoint=T,this._outbox=[],this._proxy=f({},this._dispatcher.proxy),this._proxy.origin||(this._proxy.origin=this._findProxy())},close:function(){},encode:function(){return''},sendMessage:function(N){return(this.debug('Client ? sending message to ?: ?',this._dispatcher.clientId,h.stringify(this.endpoint),N),!this.batching)?_.resolve(this.request([N])):(this._outbox.push(N),this._flushLargeBatch(),N.channel===E.HANDSHAKE)?this._publish(0.01):(N.channel===E.CONNECT&&(this._connectMessage=N),this._publish(this.MAX_DELAY))},_makePromise:function(){var N=this;this._requestPromise=this._requestPromise||new _(function(T){N._resolvePromise=T})},_publish:function(N){return this._makePromise(),this.addTimeout('publish',N,function(){this._flush(),delete this._requestPromise},this),this._requestPromise},_flush:function(){this.removeTimeout('publish'),1<this._outbox.length&&this._connectMessage&&(this._connectMessage.advice={timeout:0}),this._resolvePromise(this.request(this._outbox)),this._connectMessage=null,this._outbox=[]},_flushLargeBatch:function(){var N=this.encode(this._outbox);if(!(N.length<this._dispatcher.maxRequestSize)){var T=this._outbox.pop();this._makePromise(),this._flush(),T&&this._outbox.push(T)}},_receive:function(N){if(N){N=[].concat(N),this.debug('Client ? received from ? via ?: ?',this._dispatcher.clientId,h.stringify(this.endpoint),this.connectionType,N);for(var T=0,S=N.length;T<S;T++)this._dispatcher.handleResponse(N[T])}},_handleError:function(N){N=[].concat(N),this.debug('Client ? failed to send to ? via ?: ?',this._dispatcher.clientId,h.stringify(this.endpoint),this.connectionType,N);for(var T=0,S=N.length;T<S;T++)this._dispatcher.handleError(N[T])},_getCookies:function(){var N=this._dispatcher.cookies,T=h.stringify(this.endpoint);return N?m.map(N.getCookiesSync(T),function(S){return S.cookieString()}).join('; '):''},_storeCookies:function(N){var O,T=this._dispatcher.cookies,S=h.stringify(this.endpoint);if(N&&T){N=[].concat(N);for(var I=0,D=N.length;I<D;I++)O=u.parse(N[I]),T.setCookieSync(O,S)}},_findProxy:function(){if('undefined'==typeof d)return void 0;var N=this.endpoint.protocol;if(!N)return void 0;var I,D,T=N.replace(/:$/,'').toLowerCase()+'_proxy',S=T.toUpperCase(),O=d.env;return'http_proxy'==T&&O.REQUEST_METHOD?(I=Object.keys(O).filter(function(R){return /^http_proxy$/i.test(R)}),1===I.length?I[0]===T&&void 0===O[S]&&(D=O[T]):1<I.length&&(D=O[T]),D=D||O['CGI_'+S]):(D=O[T]||O[S],D&&!O[T]&&console.warn('The environment variable '+S+' is discouraged. Use '+T+'.')),D}}),{get:function(N,T,S,O,I){var D=N.endpoint;m.asyncEach(this._transports,function(R,w){var U=R[0],L=R[1],A=N.endpointFor(U);return 0<=m.indexOf(S,U)?w():0>m.indexOf(T,U)?(L.isUsable(N,A,function(){}),w()):void L.isUsable(N,A,function(M){if(!M)return w();var q=L.hasOwnProperty('create')?L.create(N,A):new L(N,A);O.call(I,q)})},function(){throw new Error('Could not find a usable connection type for '+h.stringify(D))})},register:function(N,T){this._transports.push([N,T]),T.prototype.connectionType=N},getConnectionTypes:function(){return m.map(this._transports,function(N){return N[0]})},_transports:[]});f(C.prototype,b),f(C.prototype,y),s.exports=C}).call(o,a(25))},function(s){function o(){throw new Error('setTimeout has not been defined')}function a(){throw new Error('clearTimeout has not been defined')}function d(S){if(b===setTimeout)return setTimeout(S,0);if((b===o||!b)&&setTimeout)return b=setTimeout,setTimeout(S,0);try{return b(S,0)}catch(O){try{return b.call(null,S,0)}catch(I){return b.call(this,S,0)}}}function p(S){if(y===clearTimeout)return clearTimeout(S);if((y===a||!y)&&clearTimeout)return y=clearTimeout,clearTimeout(S);try{return y(S)}catch(O){try{return y.call(null,S)}catch(I){return y.call(this,S)}}}function u(){C&&N&&(C=!1,N.length?E=N.concat(E):T=-1,E.length&&_())}function _(){if(!C){var S=d(u);C=!0;for(var O=E.length;O;){for(N=E,E=[];++T<O;)N&&N[T].run();T=-1,O=E.length}N=null,C=!1,p(S)}}function h(S,O){this.fun=S,this.array=O}function m(){}var f=s.exports={},b,y;(function(){try{b='function'==typeof setTimeout?setTimeout:o}catch(S){b=o}try{y='function'==typeof clearTimeout?clearTimeout:a}catch(S){y=a}})();var E=[],C=!1,N,T=-1;f.nextTick=function(S){var O=Array(arguments.length-1);if(1<arguments.length)for(var I=1;I<arguments.length;I++)O[I-1]=arguments[I];E.push(new h(S,O)),1!==E.length||C||d(_)},h.prototype.run=function(){this.fun.apply(null,this.array)},f.title='browser',f.browser=!0,f.env={},f.argv=[],f.version='',f.versions={},f.on=m,f.addListener=m,f.once=m,f.off=m,f.removeListener=m,f.removeAllListeners=m,f.emit=m,f.binding=function(){throw new Error('process.binding is not supported')},f.cwd=function(){return'/'},f.chdir=function(){throw new Error('process.chdir is not supported')},f.umask=function(){return 0}},function(s,o){(function(a){'use strict';s.exports={addTimeout:function(d,p,u,_){if(this._timeouts=this._timeouts||{},!this._timeouts.hasOwnProperty(d)){var h=this;this._timeouts[d]=a.setTimeout(function(){delete h._timeouts[d],u.call(_)},1e3*p)}},removeTimeout:function(d){this._timeouts=this._timeouts||{};var p=this._timeouts[d];p&&(a.clearTimeout(p),delete this._timeouts[d])},removeAllTimeouts:function(){for(var d in this._timeouts=this._timeouts||{},this._timeouts)this.removeTimeout(d)}}}).call(o,function(){return this}())},function(s,o,a){(function(d){'use strict';var p=a(9),u=a(11),_=a(28),h=a(12),m=a(14),f=a(29),b=a(10),y=a(5),E=a(30),C=a(16),N=a(24),T=b(p(N,{UNCONNECTED:1,CONNECTING:2,CONNECTED:3,batching:!1,isUsable:function(S,O){this.callback(function(){S.call(O,!0)}),this.errback(function(){S.call(O,!1)}),this.connect()},request:function(S){this._pending=this._pending||new _;for(var O=0,I=S.length;O<I;O++)this._pending.add(S[O]);var D=this,R=new u(function(w){D.callback(function(U){!U||1!==U.readyState||(U.send(y(S)),w(U))}),D.connect()});return{abort:function(){R.then(function(w){w.close()})}}},connect:function(){if(!T._unloaded&&(this._state=this._state||this.UNCONNECTED,this._state===this.UNCONNECTED)){this._state=this.CONNECTING;var S=this._createSocket();if(!S)return this.setDeferredStatus('failed');var O=this;S.onopen=function(){S.headers&&O._storeCookies(S.headers['set-cookie']),O._socket=S,O._state=O.CONNECTED,O._everConnected=!0,O._ping(),O.setDeferredStatus('succeeded',S)};var I=!1;S.onclose=S.onerror=function(){if(!I){I=!0;var V=O._state===O.CONNECTED;S.onopen=S.onclose=S.onerror=S.onmessage=null,delete O._socket,O._state=O.UNCONNECTED,O.removeTimeout('ping');var z=O._pending?O._pending.toArray():[];delete O._pending,V||O._everConnected?(O.setDeferredStatus('unknown'),O._handleError(z,V)):O.setDeferredStatus('failed')}},S.onmessage=function(V){var z;try{z=JSON.parse(V.data)}catch(Y){}if(z){z=[].concat(z);for(var G=0,X=z.length;G<X;G++)void 0!==z[G].successful&&O._pending.remove(z[G]);O._receive(z)}}}},close:function(){this._socket&&this._socket.close()},_createSocket:function(){var S=T.getSocketUrl(this.endpoint),O=this._dispatcher.headers,I=this._dispatcher.wsExtensions,D=this._getCookies(),R=this._dispatcher.tls,w={extensions:I,headers:O,proxy:this._proxy,tls:R};return''!==D&&(w.headers.Cookie=D),E.create(S,[],w)},_ping:function(){!this._socket||1!==this._socket.readyState||(this._socket.send('[]'),this.addTimeout('ping',this._dispatcher.timeout/2,this._ping,this))}}),{PROTOCOLS:{'http:':'ws:','https:':'wss:'},create:function(S,O){var I=S.transports.websocket=S.transports.websocket||{};return I[O.href]=I[O.href]||new this(S,O),I[O.href]},getSocketUrl:function(S){return S=f(S),S.protocol=this.PROTOCOLS[S.protocol],h.stringify(S)},isUsable:function(S,O,I,D){this.create(S,O).isUsable(I,D)}});b(T.prototype,C),m.Event&&d.onbeforeunload!==void 0&&m.Event.on(d,'beforeunload',function(){T._unloaded=!0}),s.exports=T}).call(o,function(){return this}())},function(s,o,a){'use strict';var d=a(9);s.exports=d({initialize:function(){this._index={}},add:function(p){var u=void 0===p.id?p:p.id;return!this._index.hasOwnProperty(u)&&(this._index[u]=p,!0)},forEach:function(p,u){for(var _ in this._index)this._index.hasOwnProperty(_)&&p.call(u,this._index[_])},isEmpty:function(){for(var p in this._index)if(this._index.hasOwnProperty(p))return!1;return!0},member:function(p){for(var u in this._index)if(this._index[u]===p)return!0;return!1},remove:function(p){var u=void 0===p.id?p:p.id,_=this._index[u];return delete this._index[u],_},toArray:function(){var p=[];return this.forEach(function(u){p.push(u)}),p}})},function(s){'use strict';var o=function(a){var d,p,u;if(a instanceof Array){for(d=[],p=a.length;p--;)d[p]=o(a[p]);return d}if('object'==typeof a){for(u in d=null===a?null:{},a)d[u]=o(a[u]);return d}return a};s.exports=o},function(s,o){(function(a){'use strict';var d=a.MozWebSocket||a.WebSocket;s.exports={create:function(p){return'function'==typeof d?new d(p):null}}}).call(o,function(){return this}())},function(s,o,a){(function(d){'use strict';var p=a(9),u=a(12),_=a(29),h=a(10),m=a(16),f=a(24),b=a(32),y=h(p(f,{initialize:function(E,C){if(f.prototype.initialize.call(this,E,C),!d.EventSource)return this.setDeferredStatus('failed');this._xhr=new b(E,C),C=_(C),C.pathname+='/'+E.clientId;var N=new d.EventSource(u.stringify(C)),T=this;N.onopen=function(){T._everConnected=!0,T.setDeferredStatus('succeeded')},N.onerror=function(){T._everConnected?T._handleError([]):(T.setDeferredStatus('failed'),N.close())},N.onmessage=function(S){var O;try{O=JSON.parse(S.data)}catch(I){}O?T._receive(O):T._handleError([])},this._socket=N},close:function(){this._socket&&(this._socket.onopen=this._socket.onerror=this._socket.onmessage=null,this._socket.close(),delete this._socket)},isUsable:function(E,C){this.callback(function(){E.call(C,!0)}),this.errback(function(){E.call(C,!1)})},encode:function(E){return this._xhr.encode(E)},request:function(E){return this._xhr.request(E)}}),{isUsable:function(E,C,N,T){var S=E.clientId;return S?void b.isUsable(E,C,function(O){return O?void this.create(E,C).isUsable(N,T):N.call(T,!1)},this):N.call(T,!1)},create:function(E,C){var N=E.transports.eventsource=E.transports.eventsource||{},T=E.clientId,S=_(C);return S.pathname+='/'+(T||''),S=u.stringify(S),N[S]=N[S]||new this(E,C),N[S]}});h(y.prototype,m),s.exports=y}).call(o,function(){return this}())},function(s,o,a){(function(d){'use strict';var p=a(9),u=a(12),_=a(14),h=a(10),m=a(5),f=a(24),b=h(p(f,{encode:function(y){return m(y)},request:function(y){var N,E=this.endpoint.href,C=this;if(d.XMLHttpRequest)N=new XMLHttpRequest;else if(d.ActiveXObject)N=new ActiveXObject('Microsoft.XMLHTTP');else return this._handleError(y);N.open('POST',E,!0),N.setRequestHeader('Content-Type','application/json'),N.setRequestHeader('Pragma','no-cache'),N.setRequestHeader('X-Requested-With','XMLHttpRequest');var T=this._dispatcher.headers;for(var S in T)T.hasOwnProperty(S)&&N.setRequestHeader(S,T[S]);var O=function(){N.abort()};return void 0!==d.onbeforeunload&&_.Event.on(d,'beforeunload',O),N.onreadystatechange=function(){if(N&&4===N.readyState){var I=null,D=N.status,R=N.responseText;if(void 0!==d.onbeforeunload&&_.Event.detach(d,'beforeunload',O),N.onreadystatechange=function(){},N=null,!(200<=D&&300>D||304===D||1223===D))return C._handleError(y);try{I=JSON.parse(R)}catch(K){}I?C._receive(I):C._handleError(y)}},N.send(this.encode(y)),N}}),{isUsable:function(y,E,C,N){var T='ReactNative'===navigator.product||u.isSameOrigin(E);C.call(N,T)}});s.exports=b}).call(o,function(){return this}())},function(s,o,a){(function(d){'use strict';var p=a(9),u=a(28),_=a(12),h=a(10),m=a(5),f=a(24),b=h(p(f,{encode:function(y){return'message='+encodeURIComponent(m(y))},request:function(y){var O,E=d.XDomainRequest?XDomainRequest:XMLHttpRequest,C=new E,N=++b._id,T=this._dispatcher.headers,S=this;if(C.open('POST',_.stringify(this.endpoint),!0),C.setRequestHeader)for(O in C.setRequestHeader('Pragma','no-cache'),T)T.hasOwnProperty(O)&&C.setRequestHeader(O,T[O]);var I=function(){return!!C&&void(b._pending.remove(N),C.onload=C.onerror=C.ontimeout=C.onprogress=null,C=null)};return C.onload=function(){var D;try{D=JSON.parse(C.responseText)}catch(R){}I(),D?S._receive(D):S._handleError(y)},C.onerror=C.ontimeout=function(){I(),S._handleError(y)},C.onprogress=function(){},E===d.XDomainRequest&&b._pending.add({id:N,xhr:C}),C.send(this.encode(y)),C}}),{_id:0,_pending:new u,isUsable:function(y,E,C,N){if(_.isSameOrigin(E))return C.call(N,!1);if(d.XDomainRequest)return C.call(N,E.protocol===location.protocol);if(d.XMLHttpRequest){var T=new XMLHttpRequest;return C.call(N,void 0!==T.withCredentials)}return C.call(N,!1)}});s.exports=b}).call(o,function(){return this}())},function(s,o,a){(function(d){'use strict';var p=a(9),u=a(12),_=a(29),h=a(10),m=a(5),f=a(24),b=h(p(f,{encode:function(y){var E=_(this.endpoint);return E.query.message=m(y),E.query.jsonp='__jsonp'+b._cbCount+'__',u.stringify(E)},request:function(y){var E=document.getElementsByTagName('head')[0],C=document.createElement('script'),N=b.getCallbackName(),T=_(this.endpoint),S=this;T.query.message=m(y),T.query.jsonp=N;var O=function(){if(!d[N])return!1;d[N]=void 0;try{delete d[N]}catch(I){}C.parentNode.removeChild(C)};return d[N]=function(I){O(),S._receive(I)},C.type='text/javascript',C.src=u.stringify(T),E.appendChild(C),C.onerror=function(){O(),S._handleError(y)},{abort:O}}}),{_cbCount:0,getCallbackName:function(){return this._cbCount+=1,'__jsonp'+this._cbCount+'__'},isUsable:function(y,E,C,N){C.call(N,!0)}});s.exports=b}).call(o,function(){return this}())},function(s,o,a){'use strict';var d=a(10),p=function(u,_){this.message=u,this.options=_,this.attempts=0};d(p.prototype,{getTimeout:function(){return this.options.timeout},getInterval:function(){return this.options.interval},isDeliverable:function(){var u=this.options.attempts,_=this.attempts,h=this.options.deadline,m=new Date().getTime();return void 0!==u&&_>=u?!1:void 0!==h&&m>h?!1:!0},send:function(){this.attempts+=1},succeed:function(){},fail:function(){},abort:function(){}}),s.exports=p},function(s,o,a){'use strict';var d=a(9),p=a(20),u=d({initialize:function(m,f,b){this.code=m,this.params=Array.prototype.slice.call(f),this.message=b},toString:function(){return this.code+':'+this.params.join(',')+':'+this.message}});u.parse=function(m){if(m=m||'',!p.ERROR.test(m))return new u(null,[],m);var f=m.split(':'),b=parseInt(f[0]),y=f[1].split(','),m=f[2];return new u(b,y,m)};var _={versionMismatch:[300,'Version mismatch'],conntypeMismatch:[301,'Connection types not supported'],extMismatch:[302,'Extension mismatch'],badRequest:[400,'Bad request'],clientUnknown:[401,'Unknown client'],parameterMissing:[402,'Missing required parameter'],channelForbidden:[403,'Forbidden channel'],channelUnknown:[404,'Unknown channel'],channelInvalid:[405,'Invalid channel'],extUnknown:[406,'Unknown extension'],publishFailed:[407,'Failed to publish'],serverError:[500,'Internal server error']};for(var h in _)(function(m){u[m]=function(){return new u(_[m][0],arguments,_[m][1]).toString()}})(h);s.exports=u},function(s,o,a){'use strict';var d=a(10),p=a(4),u={addExtension:function(_){this._extensions=this._extensions||[],this._extensions.push(_),_.added&&_.added(this)},removeExtension:function(_){if(this._extensions)for(var h=this._extensions.length;h--;)this._extensions[h]===_&&(this._extensions.splice(h,1),_.removed&&_.removed(this))},pipeThroughExtensions:function(_,h,m,f,b){if(this.debug('Passing through ? extensions: ?',_,h),!this._extensions)return f.call(b,h);var y=this._extensions.slice(),E=function(C){if(!C)return f.call(b,C);var N=y.shift();if(!N)return f.call(b,C);var T=N[_];return T?void(3<=T.length?N[_](C,m,E):N[_](C,E)):E(C)};E(h)}};d(u,p),s.exports=u},function(s,o,a){'use strict';var d=a(9),p=a(16);s.exports=d(p)},function(s,o,a){'use strict';var d=a(9),p=a(10),u=a(16),_=d({initialize:function(h,m,f,b){this._client=h,this._channels=m,this._callback=f,this._context=b,this._cancelled=!1},withChannel:function(h,m){return this._withChannel=[h,m],this},apply:function(h,m){var f=m[0];this._callback&&this._callback.call(this._context,f.data),this._withChannel&&this._withChannel[0].call(this._withChannel[1],f.channel,f.data)},cancel:function(){this._cancelled||(this._client.unsubscribe(this._channels,this),this._cancelled=!0)},unsubscribe:function(){this.cancel()}});p(_.prototype,u),s.exports=_},function(s){const o=d=>new Promise(p=>setTimeout(p,d)),a=(d,p)=>Promise.race([d,o(p).then(()=>{throw new Error('timeout')})]);s.exports=class{constructor(p,u){this.id=p,this.pubSubClient=u,this.isConnected=!1}connect(){if(this.isConnected)return new Promise(u=>u());const p=new Promise(u=>{const _=this.pubSubClient.subscribe('/'+this.id+'/meta',h=>{'DEVICE_HANDSHAKE'===h.type&&'PONG'==h.text&&(this.isConnected=!0,u())});_.then(()=>{this.pubSubClient.publish('/'+this.id+'/meta',{type:'DEVICE_HANDSHAKE',text:'PING'})})});return a(p,2e3)}disconnect(){this.isConnected&&(this.pubSubClient.unsubscribe('/'+this.id),this.isConnected=!1)}send(p){return this.pubSubClient.publish('/'+this.id,p)}}}]);